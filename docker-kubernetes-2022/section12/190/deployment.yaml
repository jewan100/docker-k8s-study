apiVersion: apps/v1
kind: Deployment # 생성할 리소스의 종류(타입), 여기서는 Deployment
metadata:
  name: my-app-deployment # Deployment 이름
  labels:
    group: example # Deployment에 부여할 메타데이터 라벨
spec:
  replicas: 1 # 유지할 Pod 개수(레플리카 수)
  selector: # 이 Deployment가 관리할 Pod를 찾는 기준(셀렉터)
    matchLabels:
      app: my-app # 라벨이 app=my-app인 Pod 선택
      tier: backend # 라벨이 tier=backend인 Pod 선택
  template: # selector에 매칭될 Pod 템플릿 정의
    metadata:
      labels:
        app: my-app # 생성되는 Pod에 부여할 라벨
        tier: backend # selector와 일치하도록 tier 라벨도 부여
    spec: # Pod 스펙 정의
      containers: # Pod 안에 포함될 컨테이너 목록
        - name: my-node # 컨테이너 이름
          image: jewan100/kub-first-app:2 # 사용할 컨테이너 이미지
          imagePullPolicy: Always # 항상 레지스트리에서 이미지를 다시 pull
          livenessProbe: # 컨테이너 생존 여부를 주기적으로 체크하는 프로브
            httpGet: # HTTP GET 방식으로 헬스 체크 수행
              path: / # 헬스 체크 요청을 보낼 경로
              port: 8080 # 헬스 체크 요청을 보낼 컨테이너 포트
            periodSeconds: 10 # 헬스 체크 주기(초)
            initialDelaySeconds: 5 # 컨테이너 시작 후 첫 체크까지 대기 시간(초)
